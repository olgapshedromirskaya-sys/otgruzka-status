## Telegram bot + WebApp для FBS (WB и Ozon)

Готовый MVP-проект для продавца маркетплейсов по схеме FBS:
- Telegram-бот с кнопкой открытия WebApp
- WebApp-дашборд (в стиле тёмной аналитики)
- Учёт заказов WB/Ozon и история статусов с датами
- SQLite-хранилище

### Что отслеживается

Для **WB** и **Ozon** одинаково поддерживаются статусы:

1. Сборка  
2. Сдача на склад маркетплейса  
3. Прошел сортировку  
4. В пути на ПВЗ покупателя  
5. Прибыл на ПВЗ покупателя  
6. Выкуп  
7. Отказ  
8. Возврат  
9. Брак  
10. Возврат в пути от покупателя  
11. Возврат прибыл на ПВЗ продавца

У каждого статуса хранится дата/время события.

---

## Стек

- Python 3.11+
- FastAPI (API + статика WebApp)
- SQLAlchemy + SQLite
- aiogram (Telegram bot)

---

## Быстрый старт

### 1) Установка

```bash
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

### 2) Настройка env

```bash
cp .env.example .env
```

Заполните в `.env`:
- `BOT_TOKEN` — токен Telegram-бота
- `WEBAPP_URL` — публичный URL вашего приложения (например, через VPS или ngrok)

### 3) Запуск API/WebApp

```bash
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

WebApp будет доступен по:
- `http://localhost:8000/`

### 4) (Опционально) Добавить демо-данные

```bash
python -m app.seed_demo
```

### 5) Запуск Telegram-бота

```bash
python -m app.bot
```

---

## Основные API-эндпоинты

- `GET /api/meta/statuses` — справочник статусов
- `GET /api/orders` — список заказов (фильтры marketplace/status/search)
- `POST /api/orders` — создать заказ
- `POST /api/orders/{order_id}/events` — добавить статус-событие с датой
- `GET /api/dashboard/{marketplace}` — сводка для `wb` или `ozon`

---

## Как это использовать в реальной работе

1. Создавайте заказ сразу после появления в кабинете WB/Ozon.
2. По мере прохождения логистики добавляйте события со статусом и датой.
3. Контролируйте в дашборде:
   - просрочки по сдаче на склад,
   - долю выкупа,
   - количество отказов/возвратов/брака,
   - распределение по текущим этапам.
4. В боте используйте кнопки сводки WB/Ozon и переход в WebApp.

---

## Дальнейшее развитие

- Автосинхронизация через API WB/Ozon
- Push-алерты в Telegram по SLA (просрочка отгрузки, рост отказов)
- Отчёты по SKU/складам/ПВЗ и юнит-экономика
